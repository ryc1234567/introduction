<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>x Â· HTML äº‘æ‰˜ç®¡ï¼ˆè¦†ç›– / åˆ é™¤ï¼‰</title>
<style>
body {
  font-family: Arial, sans-serif;
  margin: 20px;
}
input {
  width: 260px;
}
textarea {
  width: 100%;
  height: 220px;
}
button {
  padding: 6px 14px;
  margin-right: 8px;
}
iframe {
  width: 100%;
  height: 420px;
  border: 1px solid #aaa;
}
hr {
  margin: 30px 0;
}
</style>
</head>
<body>

<h2>ğŸ“„ å»ºç«‹ / è¦†ç›–ç½‘é¡µ</h2>

<p>
ç½‘å€å­—ç¬¦ä¸²ï¼š
<input id="name" placeholder="ä¾‹å¦‚ test">
</p>

<p>HTML ä»£ç ï¼ˆå®Œæ•´ HTMLï¼Œå¯ç›´æ¥è¿è¡Œï¼‰ï¼š</p>
<textarea id="code" placeholder="ç²˜è´´ HTML ä»£ç "></textarea>

<p>
<button onclick="createPage()">å»ºç«‹ / è¦†ç›–</button>
<button onclick="deletePage()">åˆ é™¤</button>
</p>

<p id="result"></p>

<hr>

<h2>ğŸ” æŸ¥çœ‹ç½‘é¡µ</h2>

<p>
<input id="viewName" placeholder="è¾“å…¥ç½‘å€å­—ç¬¦ä¸²">
<button onclick="viewPage()">æŸ¥çœ‹</button>
</p>

<h3>â–¶ è¿è¡Œç»“æœ</h3>
<iframe id="frame"></iframe>

<script>
/*
==============================
æŠŠè¿™é‡Œæ¢æˆä½ çš„äº‘ç«¯æ¥å£åœ°å€
ä¾‹å¦‚ï¼šhttps://x.workers.dev
==============================
*/
const API_BASE = "https://x.workers.dev";

/* å»ºç«‹ / è¦†ç›– */
function createPage() {
  const name = nameInput().value;
  const html = codeInput().value;

  if (!name || !html) {
    alert("è¯·è¾“å…¥ç½‘å€å­—ç¬¦ä¸²å’Œ HTML ä»£ç ");
    return;
  }

  fetch(API_BASE + "/create", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ name, html })
  })
  .then(r => r.json())
  .then(d => {
    result().innerHTML =
      `âœ… æˆåŠŸï¼š<a href="${d.url}" target="_blank">${d.url}</a>`;
  })
  .catch(() => alert("å»ºç«‹å¤±è´¥"));
}

/* åˆ é™¤ */
function deletePage() {
  const name = nameInput().value;
  if (!name) {
    alert("è¯·è¾“å…¥è¦åˆ é™¤çš„ç½‘é¡µå");
    return;
  }

  if (!confirm("ç¡®å®šåˆ é™¤é¡µé¢ï¼š" + name + " ï¼Ÿ")) return;

  fetch(API_BASE + "/delete", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ name })
  })
  .then(r => r.text())
  .then(t => {
    result().innerText = "ğŸ—‘ å·²åˆ é™¤ï¼š" + name;
    frame().src = "about:blank";
  })
  .catch(() => alert("åˆ é™¤å¤±è´¥"));
}

/* æŸ¥çœ‹ */
function viewPage() {
  const name = viewNameInput().value;
  if (!name) return;

  frame().src = API_BASE + "/view/" + name;
}

/* ç®€åŒ– DOM */
function nameInput() { return document.getElementById("name"); }
function viewNameInput() { return document.getElementById("viewName"); }
function codeInput() { return document.getElementById("code"); }
function result() { return document.getElementById("result"); }
function frame() { return document.getElementById("frame"); }
</script>

</body>
</html>
